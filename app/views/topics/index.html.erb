<h1>Welcome to forum !</h1>

<p>
  <%= form_tag topics_path, method: :get do %>
    <%= text_field_tag "keyword" %>
    <%= submit_tag "Search", class: "btn btn-default" %>
  <% end %>
  Searching keyword : <%= params[:keyword] %>
  <%= link_to 'Cancel Search', topics_path, class: 'btn btn-warning' %>
</p>

<p>
  <%= form_tag topics_path, method: :get do %>
    <%= select_tag "category", options_from_collection_for_select(Category.all, "name", "name", params[:category]), onchange: 'this.form.submit()', prompt: "ALL" %>
  <% end %>
</p>

<%= link_to 'New topic', new_topic_path , class: "btn btn-success" %><br>

<div class="paginate text-center">
	<%= paginate @topics %>
</div>

<table class="table table-hover text-center">
	<tr>
		<th class="text-center">分類</th>
		<th class="text-center">標題</th>
		<th class="text-center">留言數</th>
		<th class="text-center">建立日期</th>
		<th class="text-center">作者</th>
		<th class="text-center"></th>
	</tr>
	<% @topics.each do |t|%>
		<tr>
			<td>【<%= t.category.name %>】</td>
			<td><%= link_to t.title, topic_path(t) %></td>
			<td><%= t.comments.count %></td>
			<td><%= t.created_at.to_date %></td>
			<td><%= t.user.email %></td>
			<td>
				<% if current_user && current_user.is_creator?(t) %>
					<%= link_to 'EDIT', edit_topic_path(t), class: "btn btn-primary" %>
					<%= link_to 'DEL', topic_path(t), class: "btn btn-danger", method: :delete, data: {confirm: 'Are you sure ?'} %>
				<% end %>
			</td>
		</tr>
	<% end %>
</table>